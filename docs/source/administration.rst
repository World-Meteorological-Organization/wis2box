.. _administration:

Administration
==============

With wis2box installed, it's time to start up the box and login to the wis2box container.

.. note::

    Run ``python3 wis2box-ctl.py --help`` to for wis2box-ctl.py usage.

.. code-block:: bash

    python3 wis2box-ctl.py start
    python3 wis2box-ctl.py login

Now that you are logged into the wis2box container, its time to setup the discovery metadata and station metadata.

Creating discovery metadata
---------------------------

Descriptive metadata is required to organize and disseminate data. Create a discovery metadata control file (MCF) based 
on `pygeometa MCF`_. Below is an example discovery metadata control file for the test data.

.. code-block:: yaml

    wis2node:
        retention: P30D # Data retention time. Set in dev.env
        topic_hierarchy: observations-surface-land.mw.FWCL.landFixed
        data_category: observationsSurfaceLand
        country_code: mw
        originator: FWCL
        station_type: landFixed

    mcf:
        version: 1.0

    metadata:
        identifier: observations-surface-land.mw.FWCL.landFixed
        language: en
        language_alternate: fr
        charset: utf8
        hierarchylevel: dataset
        datestamp: 2021-11-29

    spatial:
        datatype: vector
        geomtype: point

    identification:
        language: en
        charset: utf8
        title:
            en: Surface weather observations (hourly)
        abstract:
            en: Surface weather observations (hourly)
        dates:
            creation: 2021-11-29
            publication: 2021-11-29
        keywords:
            default:
                keywords:
                    en: 
                        - surface weather
                        - temperature
                        - observations
            wmo:
                keywords:
                    en:
                        - weatherObservations
                keywords_type: theme
                vocabulary:
                    name:
                        en: WMO Category Code
                    url: https://github.com/wmo-im/wcmp-codelists/blob/main/codelists/WMO_CategoryCode.csv
            wis2:
                keywords:
                    en:
                        - mw.malawi.weatherObservations.dataset_name
                keywords_type: theme
                vocabulary:
                    name:
                        en: WMO Core Metadata profile topic hierarchy
                    url: https://github.com/wmo-im/wcmp2-codelists/blob/main/codelists/topic_hierarchy.csv
            
        topiccategory:
            - climatologyMeteorologyAtmosphere
        extents:
            spatial:
                - bbox: [32.6881653175,-16.8012997372,35.7719047381,-9.23059905359]
                crs: 4326
            temporal:
                - begin: 2021-11-29
                end: null
                resolution: P1H
        fees: None
        accessconstraints: otherRestrictions
        rights:
            en: WMO Unified Policy for the International Exchange of Earth System Data
        url: https://example.org/malawi-surface-weather-observations
        status: onGoing
        maintenancefrequency: continual

    contact:
        pointOfContact: &contact_poc
            organization: Department of Climate Change and Meteorologial Services (DCCMS)
            url: https://www.metmalawi.gov.mw
            individualname: Firstname Lastname
            positionname: Position Name
            phone: +265-1-822-014
            fax: +265-1-822-215
            address: P.O. Box 1808
            city: Blantyre
            administrativearea: Blantyre District
            postalcode: M3H 5T4
            country: Malawi
            email: you@example.org
            hoursofservice: 0700h - 1500h UTC
            contactinstructions: email

        distributor: *contact_poc

    dataquality:
        scope:
            level: dataset
        lineage:
            statement: this data was generated by the csv2bufr tool

Once you have generated your metadata control file, publish it to the Open API using the command:

.. code-block:: bash

    wis2box metadata discovery publish path/to/discovery-metadata.yml


Cache station metadata
----------------------

..
    TODO: Cache station metadata

Summary
-------

..
    TODO: Summary

.. _`pygeometa MCF`: https://geopython.github.io/pygeometa/reference/mcf
